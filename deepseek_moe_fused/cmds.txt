ssh cuda5

cd ../..
cd scratch/mc10322

git clone git@github.com:Monishver11/deepseek_moe_fused.git

cd deepseek_moe_fused

conda env create -f environment.yml

conda activate deepseek_moe_fused

pip install "numpy<2" --upgrade --force-reinstall
conda install "numpy<2"

pip install --force-reinstall torch==2.2.2+cu121 --index-url https://download.pytorch.org/whl/cu121

python -c "import torch, triton; print(torch.__version__, triton.__version__)"

python - << 'EOF'
import torch
print("CUDA Available:", torch.cuda.is_available())
print("Device:", torch.cuda.get_device_name(0) if torch.cuda.is_available() else "None")
EOF

python -m benchmark
